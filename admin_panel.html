<!DOCTYPE html>
<html  lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
    body,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: "Raleway", Arial, Helvetica, sans-serif
    }
    .styled-table thead tr {
      background-color: #009879;
      color: #ffffff;
      text-align: center;
    }
    .styled-table th,
    .styled-table td {
      padding: 1px 15px;
    }
    .styled-table tbody tr {
      border-bottom: 1px solid #dddddd;
    }

    .styled-table tbody tr:nth-of-type(even) {
      background-color: #f3f3f3;
    }

    .styled-table tbody tr:last-of-type {
      border-bottom: 2px solid #009879;
    }

    .styled-table tbody tr.active-row {
      font-weight: bold;
      color: #009879;
    }
    .bgimg {
      background-image: url('https://www.dierks.company/wp-content/uploads/QA-fur-AWS-Kunden-banner.jpg');

      /* Full height */
      height: 1000px;

      /* Center and scale the image nicely */
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }
  </style>

<script src="js/vendor/jquery-3.1.0.js"></script>
<script src="js/vendor/bootstrap.min.js"></script>
<script src="js/vendor/aws-cognito-sdk.min.js"></script>
<script src="js/vendor/amazon-cognito-identity.min.js"></script>
<script src="https://js.arcgis.com/4.3/"></script>
<script src="js/config_admin.js"></script>
<script src="js/cognito-auth.js"></script>

  <script>
    var callHotelGuestListAPI2 = async () => {  //Start of get boooking reservation API
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      var requestOptions = {
        method: 'GET',
        headers: myHeaders,
        redirect: 'follow'
      };
      const res = await fetch("https://v69x1qvvyj.execute-api.us-west-1.amazonaws.com/dev/booking", requestOptions);
      const json = await res.json();
      const body = json.body.Items;
      console.log(body);

      const customer_len = Object.keys(body).length;
      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          if (col[j] === 'hotel') {
            tabCell.innerHTML = body[i][col[j]].hotelId;
          }
          else {
            tabCell.innerHTML = body[i][col[j]];
          }
        }
      }

      var divContainer = document.getElementById("guestList");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
    </script>
  <script>
    var callHotelGuestListAPI = async (hotelId) => {
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      var raw = JSON.stringify({"hotelId": hotelId});
      var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
      };
      const res = await fetch("https://n5aayjkd17.execute-api.us-east-1.amazonaws.com/test", requestOptions);
      const json = await res.json();
      const body = json['guestList'];
      const customer_len = Object.keys(body).length;

      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = body[i][col[j]];
        }
      }

      var divContainer = document.getElementById("guestList");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
  </script>

  <script>
    var callGuestInfoAPI = async (guestId) => {
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      var raw = JSON.stringify({"guestId": guestId});
      var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
      };
      const res = await fetch("https://n5aayjkd17.execute-api.us-east-1.amazonaws.com/test", requestOptions);
      const json = await res.json();
      const body = json['guestList'];
      const customer_len = Object.keys(body).length;

      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = body[i][col[j]];
        }
      }

      var divContainer = document.getElementById("guestInfo");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
  </script>

  <script>
    var callGuestInfoAPI = async (guestId) => {
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      var raw = JSON.stringify({"guestId": guestId});
      var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
      };
      const res = await fetch("https://839w00d84j.execute-api.us-east-1.amazonaws.com/test", requestOptions);
      const json = await res.json();
      const body = json['guest'];
      const customer_len = Object.keys(body).length;

      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = body[i][col[j]];
        }
      }

      var divContainer = document.getElementById("guestInfo");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
  </script>
  <script>
    var callGuestBookingAPI2 = async (username) => {  //Start of get boooking reservation API
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      console.log(username);
      var raw = JSON.stringify({
        "username": username,
      });
      var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
      };
      const res = await fetch("https://v69x1qvvyj.execute-api.us-west-1.amazonaws.com/dev/booking/byuser", requestOptions);
      const json = await res.json();
      const body = json.body.Items;
      console.log(body);

      const customer_len = Object.keys(body).length;
      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          if (col[j] === 'hotel') {
            tabCell.innerHTML = body[i][col[j]].hotelId;
          }
          else {
            tabCell.innerHTML = body[i][col[j]];
          }
        }
      }

      var divContainer = document.getElementById("guestBooking");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
  </script>
  <script>
    var callGuestBookingAPI = async (guestId) => {
      var myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");
      var raw = JSON.stringify({"guestId": guestId});
      var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
      };
      const res = await fetch("https://bt5te3yrug.execute-api.us-east-1.amazonaws.com/test", requestOptions);
      const json = await res.json();
        const body = json['bookingList'];
      const customer_len = Object.keys(body).length;

      var col = [];
      for (let i = 0; i < customer_len; i++) {
        for (var key in body[i]) {
          if(col.indexOf(key) === -1) {
            col.push(key);
          }
        }
      }

      var table = document.createElement("table");

      var tr = table.insertRow(-1);                   // TABLE ROW.

      for (var i = 0; i < col.length; i++) {
        var th = document.createElement("th");      // TABLE HEADER.
        th.innerHTML = col[i];
        tr.appendChild(th);
      }

      for (var i = 0; i < customer_len; i++) {

        tr = table.insertRow(-1);

        for (var j = 0; j < col.length; j++) {
          var tabCell = tr.insertCell(-1);
          tabCell.innerHTML = body[i][col[j]];
        }
      }

      var divContainer = document.getElementById("guestBooking");
      divContainer.innerHTML = "";
      divContainer.appendChild(table);
    }
  </script>

  <title>Admin Panel</title>
</head>

<body class="bgimg w3-center">


<div class="w3-container w3-margin-top w3-center w3-white" id="Panel">
  <h3>Admin Control Panel</h3>
  <div class="w3-right">
    <a href="index.html" onClick="myCognitoAuth.signOut();" class="nav-link">Sign Out</a> 
  </div>
</div>

<div class="w3-row-padding w3-padding-16">
  <div class="w3-margin-bottom">
    <div class="w3-container w3-white">
      <h3>List of the files uploaded by all users</h3>
      <button type="button" onclick="callHotelGuestListAPI2()">Get uploaded file List</button>
      <p class="styled-table" id="guestList"> </p>
    </div>
  </div>
  <div class="w3-half w3-margin-bottom">
  </div>
  
</div>
<p class="w3-green w3-center w3-xlarge"></p>

</body>

</html>